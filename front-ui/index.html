<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <title>Банк — аккаунты</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }

        input,
        button {
            margin: .3em;
        }

        table {
            border-collapse: collapse;
            margin-top: 1em;
        }

        td,
        th {
            border: 1px solid #ccc;
            padding: .5em 1em;
        }
    </style>
</head>

<body>
    <h1>Счета клиента</h1>

    <div>
        <h3>Создать счёт</h3>
        <input id="currency" placeholder="Валюта (например USD)" />
        <button onclick="createAccount()">Создать</button>
    </div>

    <div>
        <h3>Счета</h3>
        <button onclick="loadAccounts()">Обновить</button>
        <table id="accountsTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Валюта</th>
                    <th>Баланс</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const API = 'http://localhost:8080/api/accounts';

        async function loadAccounts() {
            const res = await fetch(API);
            const accounts = await res.json();
            const tbody = document.querySelector('#accountsTable tbody');
            tbody.innerHTML = '';
            accounts.forEach(acc => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
      <td>${acc.id}</td>
      <td>${acc.currency}</td>
      <td>${acc.balance}</td>
      <td>
        <button onclick="deposit(${acc.id})">+100</button>
        <button onclick="withdraw(${acc.id})">−100</button>
      </td>`;
                tbody.appendChild(tr);
            });
        }

        async function createAccount() {
            const currency = document.getElementById('currency').value;
            await fetch(API, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ ownerId: 'user1', currency, balance: 0 })
            });
            loadAccounts();
        }

        async function deposit(id) {
            await fetch(`${API}/${id}/deposit?amount=100`, { method: 'POST' });
            loadAccounts();
        }

        async function withdraw(id) {
            await fetch(`${API}/${id}/withdraw?amount=100`, { method: 'POST' });
            loadAccounts();
        }

        loadAccounts();
    </script>
</body>

</html>